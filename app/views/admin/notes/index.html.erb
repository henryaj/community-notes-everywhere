<div class="max-w-7xl mx-auto px-6 py-12">
  <a href="/admin" class="text-blue-600 hover:underline text-sm">&larr; Back to Dashboard</a>
  <h1 class="text-2xl font-bold mt-4 mb-2">All Notes</h1>
  <p class="text-sm text-gray-500 mb-8"><%= @total_count %> notes total</p>

  <% if @notes.any? %>
    <div class="space-y-6">
      <% @notes.each do |note| %>
        <div class="border border-gray-200 rounded-lg p-5">
          <div class="flex items-center gap-4 text-sm mb-3">
            <span class="font-medium">@<%= note.author.twitter_handle %></span>
            <span class="text-gray-300">&middot;</span>
            <span class="text-gray-500"><%= note.created_at.strftime("%b %d, %Y") %></span>
            <span class="text-gray-300">&middot;</span>
            <% if note.reports_count >= 3 %>
              <span class="inline-block px-2 py-0.5 text-xs font-medium rounded-full bg-red-100 text-red-800">hidden</span>
            <% elsif note.reports_count > 0 %>
              <span class="inline-block px-2 py-0.5 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800">flagged (<%= note.reports_count %>)</span>
            <% else %>
              <span class="inline-block px-2 py-0.5 text-xs font-medium rounded-full bg-green-100 text-green-800">visible</span>
            <% end %>
          </div>

          <div class="bg-gray-50 rounded-md p-4 mb-3">
            <p class="text-sm text-gray-800 whitespace-pre-wrap"><%= note.body %></p>
          </div>

          <% if note.selected_text.present? %>
            <div class="mb-3">
              <span class="text-xs font-medium text-gray-500">Selected text on page:</span>
              <p class="text-sm text-gray-600 italic mt-1">&ldquo;<%= note.selected_text %>&rdquo;</p>
            </div>
          <% end %>

          <div>
            <span class="text-xs font-medium text-gray-500">Source page:</span>
            <a href="<%= note.page.url %>" target="_blank" rel="noopener" class="text-sm text-blue-600 hover:underline ml-1"><%= note.page.url %></a>
          </div>
        </div>
      <% end %>
    </div>

    <% if @total_pages > 1 %>
      <nav class="flex items-center justify-center gap-2 mt-8">
        <% if @page_num > 1 %>
          <a href="?page=<%= @page_num - 1 %>" class="px-3 py-1 text-sm rounded bg-gray-100 text-gray-700 hover:bg-gray-200">&larr; Previous</a>
        <% end %>

        <% (1..@total_pages).each do |p| %>
          <% if p == @page_num %>
            <span class="px-3 py-1 text-sm rounded bg-blue-600 text-white font-medium"><%= p %></span>
          <% elsif (p - @page_num).abs <= 2 || p == 1 || p == @total_pages %>
            <a href="?page=<%= p %>" class="px-3 py-1 text-sm rounded bg-gray-100 text-gray-700 hover:bg-gray-200"><%= p %></a>
          <% elsif (p - @page_num).abs == 3 %>
            <span class="text-gray-400">&hellip;</span>
          <% end %>
        <% end %>

        <% if @page_num < @total_pages %>
          <a href="?page=<%= @page_num + 1 %>" class="px-3 py-1 text-sm rounded bg-gray-100 text-gray-700 hover:bg-gray-200">Next &rarr;</a>
        <% end %>
      </nav>
    <% end %>
  <% else %>
    <p class="text-gray-500">No notes yet.</p>
  <% end %>
</div>
